Malware Lookup Service: This module is going to be part of the HTTP proxy, which will help in intercepting incoming traffic and checking if the URL being requested is part of the MalwareURL database list. For this exercise we are loading the malware database with URL which are defined in malware.txt file in resources directory. Any new addition to the malware database needs to be updated in the text file and server needs to restarted for teh configurations to run.

This web service demonstrates only three API requests involving GET and SET.

1. GET list of all malware URL's ---- GET v1/urlinfoall/

2. GET info about only one URL ---- GET v1/urlinfo/{query_string}

3. POST a new URL to the database --- POST v1/addURL/{new_url}.

High Level Overview: The Malware Lookup Service is comprised of these main components :
  1. Malware Lookup Controller.
  2. Configuration module.
  3. Malware Lookup URL parser and validator
  4. Malware Lookup DOA.
  5. Malware Lookup service.

Malware Lookup Controller : After all the configurations from the driver program , the controller responsible for routing all the requests which it recieves from client. It spawns a separate thread for every single GET request which it recieves. It is also reponsible for responding back to clients effectively after the thread completes it's job depending on the thread status.

Configuration module:  This module is responsible for doing all the configurations, 
  1. Reading configurations from applications.properties file and 
  2. Creating a malware database if one doesn't exist
  3. getting database connection and creating tables for storing malware URL details.
  4. Populating tables with URL's and their status from malware.txt file
    
Malware Lookup URL parser and validator: Each request that the controlles recieves is spawn as a new thread for parsing and validating client request.This is the run method which does the following things
  1. Decode the URL sent from the client.
  2. Checks for the standard schemes which are allowed ("http, ftp https")
  3. Extracts the domain name from the url
  4. Makes a database query on the domain using malwareLookupSerivce
  5. Which then uses appropriate DAO to check if the URL is part of the MALWAREDATABASE
  6. Updates appropriate attributes such that controller can respond back to clients effectively.

Malware Lookup DOA : Malware lookup DOA  is used to separate low level Malware URL data accessing API or operations from high level API requests. It acts like an interface between high level request and low level data manipuation (accessing updating). 

Malware Lookup service : The DAO API are not directly accessible for controller, the contril forwards the requests to service module which then forwards the requests to appropriate DAO. This module acts like an interface between controller and DAO module.


Getting Started: Download IntelliJ IDEA or eclipse based on the underlying OS, make sure you have open JDK-14 installed. Install mysql if you don't have one. Install JUnit and configure it's class path.

Prerequisites: 
1. This project is built with IntelliJ Idea IDE with openJDK14.
2. Also have Junit installed in your class path to run the test cases. 
3. mysql 
4. postman 
5. Git installed.

Installing and running

To deploy using command line and git.
1. Make a directory : “mkdir malwareservice”
2. type “cd malwareservice”
3. git clone https://github.com/cnbscience/MalwareLookupService
4. cd /path/to/malwareservice/malwareService/src/main/java/com/chiddu/malwareservice/malwareService
5. javac -d /path/to/malwareservice/malwareService/target/classes/com/chiddu/malwareservice/malwareService *.java (Not     compulsory if the class files are present)
6. java -classpath  /path/to/malwareservice/malwareService/target/classes/com/chiddu/malwareservice/malwareService malwareService.MalwareServiceApplication
  
If the server is up you will see 

Creating database...
  Database MALWARESERVICEDB created successfully...
  Connecting to database...
  Creating table MALWAREURL_TBL...
  Table created successfully...


To deploy Using IDE like IntelliJ:

  1. Download the project from https://github.com/cnbscience/MalwareLookupService
  2. Import the project into IntelliJ IDEA and run build and run MalwareServiceApplication.
  3. open postman and start sending get queries like one shown below
  
  eg.
   
   Request.
      localhost:8080/v1/urlinfo?url=http%3A%2F%2Fwww.google.com
  
   Respons.
    you should recieve a response :
    {
      "id": 1,
      "url": "www.google.com",
      "status": "BAD"
    }


Until finished:
The server will keep responding until the client closes it's session. To close the server, just stop the server.

Running unit tests: In the test folder there are two types of tests

Built With ItelliJ IDEA

Versioning Malware service lookup- version 1.0

Authors Chiddu Bhat

License Free to use
